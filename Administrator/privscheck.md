*Evil-WinRM* PS C:\Users\olivia\Documents> 
	powershell -ep bypass -c ". .\PrivescCheck.ps1; Invoke-PrivescCheck -Extended -Audit -Report PrivescCheck_$($env:COMPUTERNAME) -Format TXT,HTML,CSV,XML"
????????????????????????????????????????????????????????????????
? CATEGORY ? TA0043 - Reconnaissance                           ?
? NAME     ? User identity                                     ?
????????????????????????????????????????????????????????????????
? Get information about the current user (name, domain name)   ?
? and its access token (SID, integrity level, authentication   ?
? ID).                                                         ?
????????????????????????????????????????????????????????????????
[*] Status: Informational


Name             : ADMINISTRATOR\olivia
SID              : S-1-5-21-1088858960-373806567-254189436-1108
IntegrityLevel   : Medium Plus Mandatory Level (S-1-16-8448)
SessionId        : 0
TokenId          : 00000000-00270322
AuthenticationId : 00000000-00225ce7
OriginId         : 00000000-00000000
ModifiedId       : 00000000-00225cee
Source           : NtLmSsp (00000000-00000000)




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0043 - Reconnaissance                           ?
? NAME     ? User groups                                       ?
????????????????????????????????????????????????????????????????
? Get information about the groups the current user belongs to ?
? (name, type, SID).                                           ?
????????????????????????????????????????????????????????????????
[*] Status: Informational

Name                                        Type           SID
----                                        ----           ---
ADMINISTRATOR\Domain Users                  Group          S-1-5-21-1088858960-373806567-2541894...
Everyone                                    WellKnownGroup S-1-1-0
BUILTIN\Remote Management Users             Alias          S-1-5-32-580
BUILTIN\Users                               Alias          S-1-5-32-545
BUILTIN\Pre-Windows 2000 Compatible Access  Alias          S-1-5-32-554
NT AUTHORITY\NETWORK                        WellKnownGroup S-1-5-2
NT AUTHORITY\Authenticated Users            WellKnownGroup S-1-5-11
NT AUTHORITY\This Organization              WellKnownGroup S-1-5-15
NT AUTHORITY\NTLM Authentication            WellKnownGroup S-1-5-64-10
Mandatory Label\Medium Plus Mandatory Level Label          S-1-16-8448



????????????????????????????????????????????????????????????????
? CATEGORY ? TA0043 - Reconnaissance                           ?
? NAME     ? User restricted SIDs                              ?
????????????????????????????????????????????????????????????????
? Get information about potential restricted SIDs applied to   ?
? the current user.                                            ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (nothing found)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? User privileges                                   ?
????????????????????????????????????????????????????????????????
? Check whether the current user is granted privileges that    ?
? can be leveraged for local privilege escalation.             ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

Name                          State   Description                    Exploitable
----                          -----   -----------                    -----------
SeMachineAccountPrivilege     Enabled Add workstations to domain           False
SeChangeNotifyPrivilege       Enabled Bypass traverse checking             False
SeIncreaseWorkingSetPrivilege Enabled Increase a process working set       False



????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? User privileges (GPO)                             ?
????????????????????????????????????????????????????????????????
? Check whether the current user is granted privileges,        ?
? through a group policy, that can be leveraged for local      ?
? privilege escalation.                                        ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0006 - Credential Access                        ?
? NAME     ? User environment variables                        ?
????????????????????????????????????????????????????????????????
? Check whether any environment variables contain sensitive    ?
? information such as credentials or secrets. Note that this   ?
? check follows a keyword-based approach and thus might not be ?
? completely reliable.                                         ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (nothing found)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Service list (non-default)                        ?
????????????????????????????????????????????????????????????????
? Get information about third-party services. It does so by    ?
? parsing the target executable's metadata and checking        ?
? whether the publisher is Microsoft.                          ?
????????????????????????????????????????????????????????????????
[*] Status: Informational


Name        : ssh-agent
DisplayName : OpenSSH Authentication Agent
ImagePath   : C:\Windows\System32\OpenSSH\ssh-agent.exe
User        : LocalSystem
StartMode   : Disabled

Name        : VGAuthService
DisplayName : VMware Alias Manager and Ticket Service
ImagePath   : "C:\Program Files\VMware\VMware Tools\VMware VGAuth\VGAuthService.exe"
User        : LocalSystem
StartMode   : Automatic

Name        : vm3dservice
DisplayName : @oem8.inf,%VM3DSERVICE_DISPLAYNAME%;VMware SVGA Helper Service
ImagePath   : C:\Windows\system32\vm3dservice.exe
User        : LocalSystem
StartMode   : Automatic

Name        : VMTools
DisplayName : VMware Tools
ImagePath   : "C:\Program Files\VMware\VMware Tools\vmtoolsd.exe"
User        : LocalSystem
StartMode   : Automatic




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Kernel drivers (non-default)                      ?
????????????????????????????????????????????????????????????????
? Get information about third-party kernel drivers. It does so ?
? by parsing the driver's metadata and checking whether the    ?
? publisher is Microsoft.                                      ?
????????????????????????????????????????????????????????????????
powershell -ep bypass -c ". .\PrivescCheck.ps1; Invoke-PrivescCheck -Extended -Audit -Report PrivescCheck_$($env:COMPUTERNAME) -Format TXT,HTML,CSV,XML"WARNING: Service: vwifibus | Path not found: C:\Windows\System32\drivers\vwifibus.sys
WARNING: Failed to query service '3ware'


WARNING: Failed to query service 'WinVerbs'
[*] Status: Informational (nothing found)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Vulnerable Kernel drivers                         ?
????????????????????????????????????????????????????????????????
? Check whether known vulnerable kernel drivers are installed. ?
? It does so by computing the file hash of each driver and     ?
? comparing the value against the list provided by             ?
? loldrivers.io.                                               ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Service permissions                               ?
????????????????????????????????????????????????????????????????
? Check whether the current user has any write permissions on  ?
? a service through the Service Control Manager (SCM).         ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Service registry permissions                      ?
????????????????????????????????????????????????????????????????
? Check whether the current user has any write permissions on  ?
? the configuration of a service in the registry.              ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Service image file permissions                    ?
????????????????????????????????????????????????????????????????
? Check whether the current user has any write permissions on  ?
? a service's binary or its folder.                            ?
????????????????????????????????????????????????????????????????







































Key         : HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
Value       : LocalAccountTokenFilterPolicy
Data        : (null)
Vulnerable  : False
Description : Only the built-in Administrator account (RID 500) can be granted a high integrity
              token when authenticating remotely (default).

Key         : HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
Value       : FilterAdministratorToken
Data        : (null)
Vulnerable  : True
Description : The built-in administrator account (RID 500) is granted a high integrity token when
              authenticating remotely (default).




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0006 - Credential Access                        ?
? NAME     ? LSA Protection                                    ?
????????????????????????????????????????????????????????????????
? Check whether LSA protection is enabled. Note that when LSA  ?
? protection is enabled, 'lsass.exe' runs as a Protected       ?
? Process Light (PPL) and thus can only be accessed by other   ?
? protected processes with an equivalent or higher protection  ?
? level.                                                       ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Low


Key         : HKLM\SYSTEM\CurrentControlSet\Control\Lsa
Value       : RunAsPPL
Data        : (null)
Description : LSA protection is not enabled.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0006 - Credential Access                        ?
? NAME     ? Credential Guard                                  ?
????????????????????????????????????????????????????????????????
? Check whether Credential Guard is supported and enabled.     ?
? Note that when Credential Guard is enabled, credentials are  ?
? stored in an isolated process ('LsaIso.exe') that cannot be  ?
? accessed, even if the kernel is compromised.                 ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)


SecurityServicesConfigured  : (null)
SecurityServicesRunning     : (null)
SecurityServicesDescription : Credential Guard is not supported.
LsaCfgFlagsPolicyKey        : HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard
LsaCfgFlagsPolicyValue      : LsaCfgFlags
LsaCfgFlagsPolicyData       : (null)
LsaCfgFlagsKey              : HKLM\SYSTEM\CurrentControlSet\Control\LSA
LsaCfgFlagsValue            : LsaCfgFlags
LsaCfgFlagsData             : (null)
LsaCfgFlagsDescription      : Credential Guard is not configured.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0005 - Defense Evasion                          ?
? NAME     ? Attack Surface Reduction (ASR) rules              ?
????????????????????????????????????????????????????????????????
? Get information about configured Windows Defender Exploit    ?
? Guard Attack Surface Reduction (ASR) rules.                  ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (nothing found)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0003 - Persistence                              ?
? NAME     ? UEFI & Secure Boot                                ?
????????????????????????????????????????????????????????????????
? Check whether UEFI and Secure Boot are supported and         ?
? enabled. Note that Secure Boot requires UEFI.                ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Low

Name        Vulnerable Description
----        ---------- -----------
UEFI              True BIOS mode is Legacy.
Secure Boot      False



????????????????????????????????????????????????????????????????
? CATEGORY ? TA0008 - Lateral Movement                         ?
? NAME     ? LAPS                                              ?
????????????????????????????????????????????????????????????????
? Check whether LAPS is configured and enabled. Note that this ?
? applies to domain-joined machines only.                      ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Medium


Policy      : Enable local admin password management (LAPS legacy)
Key         : HKLM\Software\Policies\Microsoft Services\AdmPwd
Default     : 0
Value       : (null)
Description : The local administrator password is not managed (default).

Policy      : LAPS > Configure password backup directory
Key         : HKLM\Software\Microsoft\Policies\LAPS
Default     : 0
Value       : (null)
Description : The local administrator password is not backed up (default).




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0005 - Defense Evasion                          ?
? NAME     ? PowerShell transcription                          ?
????????????????????????????????????????????????????????????????
? Check whether PowerShell Transcription is configured and     ?
? enabled.                                                     ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (nothing found)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0001 - Initial Access                           ?
? NAME     ? PowerShell script execution policy                ?
????????????????????????????????????????????????????????????????
? Check whether a PowerShell script execution policy is        ?
? enforced.                                                    ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Low


Description : No PowerShell execution policy is enforced.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0043 - Reconnaissance                           ?
? NAME     ? TPM device information                            ?
????????????????????????????????????????????????????????????????
? Get information about the machine's Trusted Platform Module  ?
? (TPM), if present.                                           ?
????????????????????????????????????????????????????????????????
WARNING: No TPM device found.
[*] Status: Informational


TpmPresent : False




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0001 - Initial Access                           ?
? NAME     ? BitLocker configuration                           ?
????????????????????????????????????????????????????????????????
? Check whether BitLocker is enabled on the system drive and   ?
? requires a second factor of authentication (PIN or startup   ?
? key). Note that this check might yield a false positive if a ?
? third-party drive encryption software is installed.          ?
????????????????????????????????????????????????????????????????
WARNING: No TPM device found.
[*] Status: Informational (not vulnerable)


MachineRole : Domain Controller
TpmPresent  : False
Description : Not a workstation, BitLocker configuration is irrelevant.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0005 - Defense Evasion                          ?
? NAME     ? AppLocker configuration                           ?
????????????????????????????????????????????????????????????????
? Check whether an AppLocker policy is enforced.               ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Low


RuleCount   : 0
Description : AppLocker does not seem to be configured.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0005 - Defense Evasion                          ?
? NAME     ? AppLocker policy                                  ?
????????????????????????????????????????????????????????????????
? Check whether AppLocker rules can be exploited, in the       ?
? context of the current user, to execute arbitrary code.      ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0001 - Initial Access                           ?
? NAME     ? File extension associations                       ?
????????????????????????????????????????????????????????????????
? Check whether file extensions such as '.bat' or '.wsh' are   ?
? associated to a text editor. Note that only basic text       ?
? editors such as 'Notepad' are detected. If a rich text       ?
? editor is set instead, this check could yield false          ?
? positives.                                                   ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Low

Extension           Command
---------           -------
.application        "C:\Windows\System32\rundll32.exe" "C:\Windows\System32\dfshim.dll",ShOpenVe...
.appref-ms          "C:\Windows\System32\rundll32.exe" "C:\Windows\System32\dfshim.dll",ShOpenVe...
.bat                "%1" %*
.chm                "C:\Windows\hh.exe" %1
.cmd                "%1" %*
.com                "%1" %*
.cpl                C:\Windows\System32\control.exe "%1",%*
.diagcab            C:\Windows\system32\msdt.exe /cab "%1"
.hta                C:\Windows\SysWOW64\mshta.exe "%1" {1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}%U{...
.hlp                C:\Windows\winhlp32.exe %1
.htm                "C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe" --single-argu...
.html               "C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe" --single-argu...
.js                 C:\Windows\System32\WScript.exe "%1" %*
.JSE                C:\Windows\System32\WScript.exe "%1" %*
.library-ms         C:\Windows\Explorer.exe
.mht                "C:\Program Files\Internet Explorer\iexplore.exe" %1
.mhtml              "C:\Program Files\Internet Explorer\iexplore.exe" %1
.msc                C:\Windows\system32\mmc.exe "%1" %*
.pif                "%1" %*
.psc1               "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -p "%1"
.reg                regedit.exe "%1"
.scf                C:\Windows\explorer.exe
.scr                "%1" /S
.searchConnector-ms C:\Windows\Explorer.exe
.search-ms          C:\Windows\Explorer.exe
.theme              C:\Windows\system32\rundll32.exe C:\Windows\system32\themecpl.dll,OpenThemeA...
.themepack          C:\Windows\system32\rundll32.exe C:\Windows\system32\themecpl.dll,OpenThemeA...
.URL                "C:\Windows\System32\rundll32.exe" "C:\Windows\System32\ieframe.dll",OpenURL %l
.VBE                "C:\Windows\System32\WScript.exe" "%1" %*
.vbs                "C:\Windows\System32\WScript.exe" "%1" %*
.WSF                "C:\Windows\System32\WScript.exe" "%1" %*
.WSH                "C:\Windows\System32\WScript.exe" "%1" %*



????????????????????????????????????????????????????????????????
? CATEGORY ? TA0001 - Initial Access                           ?
? NAME     ? Hidden file name extensions                       ?
????????????????????????????????????????????????????????????????
? Check whether extensions of known file types are shown or    ?
? hidden in the Explorer.                                      ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Low


Key         : HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
Value       : HideFileExt
Expected    : 0
Data        : (null)
Description : File name extensions of known file types are hidden in the Explorer.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? PATH folder permissions                           ?
????????????????????????????????????????????????????????????????
? Check whether the current user has any write permissions on  ?
? the system-wide PATH folders. If so, the system could be     ?
? vulnerable to privilege escalation through ghost DLL         ?
? hijacking.                                                   ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - High


Path              : C:\php-8.2.24
ModifiablePath    : C:\
IdentityReference : BUILTIN\Users
Permissions       : AddSubdirectory




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Known ghost DLLs                                  ?
????????????????????????????????????????????????????????????????
? Get information about services that are known to be prone to ?
? ghost DLL hijacking. Note that their exploitation requires   ?
? the current user to have write permissions on at least one   ?
? system-wide PATH folder.                                     ?
????????????????????????????????????????????????????????????????
[*] Status: Informational


Name           : cdpsgshims.dll
Description    : Loaded by the Connected Devices Platform Service (CDPSvc) upon startup.
RunAs          : NT AUTHORITY\LocalService
RebootRequired : True
Link           : https://nafiez.github.io/security/eop/2019/11/05/windows-service-host-process-eop.
                 html

Name           : WptsExtensions.dll
Description    : Loaded by the Task Scheduler service (Schedule) upon startup.
RunAs          : LocalSystem
RebootRequired : True
Link           : http://remoteawesomethoughts.blogspot.com/2019/05/windows-10-task-schedulerservice
                 .html

Name           : SprintCSP.dll
Description    : Loaded by the Storage Service (StorSvc) when the RPC procedure
                 'SvcRebootToFlashingMode' is invoked.
RunAs          : LocalSystem
RebootRequired : False
Link           : https://github.com/blackarrowsec/redteam-research/tree/master/LPE%20via%20StorSvc

Name           : wlanapi.dll
Description    : Loaded by the Network Connections service (NetMan) when listing network
                 interfaces.
RunAs          : LocalSystem
RebootRequired : False
Link           : https://itm4n.github.io/windows-server-netman-dll-hijacking/




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? AlwaysInstallElevated                             ?
????????????????????????????????????????????????????????????????
? Check whether the 'AlwaysInstallElevated' policy is enabled  ?
? system-wide and for the current user. If so, the current     ?
? user may install a Windows Installer package with elevated   ?
? (SYSTEM) privileges.                                         ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)


LocalMachineKey   : HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer
LocalMachineValue : AlwaysInstallElevated
LocalMachineData  : (null)
Description       : AlwaysInstallElevated is not enabled in HKLM.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0008 - Lateral Movement                         ?
? NAME     ? WSUS configuration                                ?
????????????????????????????????????????????????????????????????
? Check whether WSUS uses the HTTPS protocol to retrieve       ?
? updates from the on-premise update server. If WSUS uses the  ?
? clear-text HTTP protocol, it is vulnerable to MitM attacks   ?
? that may result in remote code execution as SYSTEM.          ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)


Key         : HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate
Value       : WUServer
Data        : (null)
Description : No WSUS server is configured (default).

Key         : HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\AU
Value       : UseWUServer
Data        : (null)
Description : WSUS server not enabled (default).

Key         : HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate
Value       : SetProxyBehaviorForUpdateDetection
Data        : (null)
Description : Proxy fallback not configured (default).

Key         : HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate
Value       : DisableWindowsUpdateAccess
Data        : (null)
Description : Windows Update features are enabled (default).




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0008 - Lateral Movement                         ?
? NAME     ? Hardened UNC paths                                ?
????????????????????????????????????????????????????????????????
? Check whether sensitive UNC paths are properly hardened.     ?
? Note that non-hardened UNC paths used for retrieving group   ?
? policies can be hijacked through an MitM attack to obtain    ?
? remote code execution as SYSTEM.                             ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0008 - Lateral Movement                         ?
? NAME     ? SMB configuration                                 ?
????????????????????????????????????????????????????????????????
? Check whether SMBv1 is enabled (server), and whether signing ?
? is required (server and client).                             ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Low


Role        : Server
Parameter   : EnableSMB1Protocol
Value       : False
Vulnerable  : False
Description : SMBv1 is disabled.

Role        : Server
Parameter   : RequireSecuritySignature
Value       : True
Vulnerable  : False
Description : SMB signing is required.

Role        : Client
Parameter   : RequireSecuritySignature
Value       : False
Vulnerable  : True
Description : SMB signing is not required.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Point and Print configuration                     ?
????????????????????????????????????????????????????????????????
? Check whether the Print Spooler service is enabled and if    ?
? the Point and Print configuration allows non-administrator   ?
? users to install printer drivers.                            ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)


Description : The Print Spooler service is disabled.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Application repair UAC prompt                     ?
????????????????????????????????????????????????????????????????
? Check whether the UAC prompt displayed when attempting an    ?
? application repair through the Windows Installer was         ?
? disabled.                                                    ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)


Key   : HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer
Value : DisableLUAInRepair
Data  : (null)




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Driver co-installers                              ?
????????????????????????????????????????????????????????????????
? Check whether Driver Co-installers are disabled. A local     ?
? user might be able to gain SYSTEM privileges by plugging in  ?
? a device such as a mouse or keyboard with a vulnerable       ?
? Driver Co-installer.                                         ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Low


Key         : HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device Installer
Value       : DisableCoInstallers
Data        : (null)
Description : Driver Co-installers are enabled (default).




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0043 - Reconnaissance                           ?
? NAME     ? SCCM cache folders                                ?
????????????????????????????????????????????????????????????????
? Get information about SCCM cache folders (incl. number and   ?
? list of binary, script, and text files).                     ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (nothing found)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? COM server registry permissions                   ?
????????????????????????????????????????????????????????????????
? Check whether the current user has any modification rights   ?
? on a COM server in the registry. This may not necessarily    ?
? result in a privilege escalation. Further analysis is        ?





























































????????????????????????????????????????????????????????????????
? Check whether the current user has any write permissions on  ?
? the system-wide PATH folders. If so, the system could be     ?
? vulnerable to privilege escalation through ghost DLL         ?
? hijacking.                                                   ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - High


Path              : C:\php-8.2.24
ModifiablePath    : C:\
IdentityReference : BUILTIN\Users
Permissions       : AddSubdirectory




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Known ghost DLLs                                  ?
????????????????????????????????????????????????????????????????
? Get information about services that are known to be prone to ?
? ghost DLL hijacking. Note that their exploitation requires   ?
? the current user to have write permissions on at least one   ?
? system-wide PATH folder.                                     ?
????????????????????????????????????????????????????????????????
[*] Status: Informational


Name           : cdpsgshims.dll
Description    : Loaded by the Connected Devices Platform Service (CDPSvc) upon startup.
RunAs          : NT AUTHORITY\LocalService
RebootRequired : True
Link           : https://nafiez.github.io/security/eop/2019/11/05/windows-service-host-process-eop.
                 html

Name           : WptsExtensions.dll
Description    : Loaded by the Task Scheduler service (Schedule) upon startup.
RunAs          : LocalSystem
RebootRequired : True
Link           : http://remoteawesomethoughts.blogspot.com/2019/05/windows-10-task-schedulerservice
                 .html

Name           : SprintCSP.dll
Description    : Loaded by the Storage Service (StorSvc) when the RPC procedure
                 'SvcRebootToFlashingMode' is invoked.
RunAs          : LocalSystem
RebootRequired : False
Link           : https://github.com/blackarrowsec/redteam-research/tree/master/LPE%20via%20StorSvc

Name           : wlanapi.dll
Description    : Loaded by the Network Connections service (NetMan) when listing network
                 interfaces.
RunAs          : LocalSystem
RebootRequired : False
Link           : https://itm4n.github.io/windows-server-netman-dll-hijacking/




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? AlwaysInstallElevated                             ?
????????????????????????????????????????????????????????????????
? Check whether the 'AlwaysInstallElevated' policy is enabled  ?
? system-wide and for the current user. If so, the current     ?
? user may install a Windows Installer package with elevated   ?
? (SYSTEM) privileges.                                         ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)


LocalMachineKey   : HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer
LocalMachineValue : AlwaysInstallElevated
LocalMachineData  : (null)
Description       : AlwaysInstallElevated is not enabled in HKLM.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0008 - Lateral Movement                         ?
? NAME     ? WSUS configuration                                ?
????????????????????????????????????????????????????????????????
? Check whether WSUS uses the HTTPS protocol to retrieve       ?
? updates from the on-premise update server. If WSUS uses the  ?
? clear-text HTTP protocol, it is vulnerable to MitM attacks   ?
? that may result in remote code execution as SYSTEM.          ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)


Key         : HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate
Value       : WUServer
Data        : (null)
Description : No WSUS server is configured (default).

Key         : HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\AU
Value       : UseWUServer
Data        : (null)
Description : WSUS server not enabled (default).

Key         : HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate
Value       : SetProxyBehaviorForUpdateDetection
Data        : (null)
Description : Proxy fallback not configured (default).

Key         : HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate
Value       : DisableWindowsUpdateAccess
Data        : (null)
Description : Windows Update features are enabled (default).




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0008 - Lateral Movement                         ?
? NAME     ? Hardened UNC paths                                ?
????????????????????????????????????????????????????????????????
? Check whether sensitive UNC paths are properly hardened.     ?
? Note that non-hardened UNC paths used for retrieving group   ?
? policies can be hijacked through an MitM attack to obtain    ?
? remote code execution as SYSTEM.                             ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0008 - Lateral Movement                         ?
? NAME     ? SMB configuration                                 ?
????????????????????????????????????????????????????????????????
? Check whether SMBv1 is enabled (server), and whether signing ?
? is required (server and client).                             ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Low


Role        : Server
Parameter   : EnableSMB1Protocol
Value       : False
Vulnerable  : False
Description : SMBv1 is disabled.

Role        : Server
Parameter   : RequireSecuritySignature
Value       : True
Vulnerable  : False
Description : SMB signing is required.

Role        : Client
Parameter   : RequireSecuritySignature
Value       : False
Vulnerable  : True
Description : SMB signing is not required.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Point and Print configuration                     ?
????????????????????????????????????????????????????????????????
? Check whether the Print Spooler service is enabled and if    ?
? the Point and Print configuration allows non-administrator   ?
? users to install printer drivers.                            ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)


Description : The Print Spooler service is disabled.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Application repair UAC prompt                     ?
????????????????????????????????????????????????????????????????
? Check whether the UAC prompt displayed when attempting an    ?
? application repair through the Windows Installer was         ?
? disabled.                                                    ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)


Key   : HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer
Value : DisableLUAInRepair
Data  : (null)




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Driver co-installers                              ?
????????????????????????????????????????????????????????????????
? Check whether Driver Co-installers are disabled. A local     ?
? user might be able to gain SYSTEM privileges by plugging in  ?
? a device such as a mouse or keyboard with a vulnerable       ?
? Driver Co-installer.                                         ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Low


Key         : HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device Installer
Value       : DisableCoInstallers
Data        : (null)
Description : Driver Co-installers are enabled (default).




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0043 - Reconnaissance                           ?
? NAME     ? SCCM cache folders                                ?
????????????????????????????????????????????????????????????????
? Get information about SCCM cache folders (incl. number and   ?
? list of binary, script, and text files).                     ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (nothing found)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? COM server registry permissions                   ?
????????????????????????????????????????????????????????????????
? Check whether the current user has any modification rights   ?
? on a COM server in the registry. This may not necessarily    ?
? result in a privilege escalation. Further analysis is        ?
? required.                                                    ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? COM server image file permissions                 ?
????????????????????????????????????????????????????????????????
? Check whether the current user has any modification rights   ?
? on a COM server module file. This may not necessarily result ?
? in a privilege escalation. Further analysis is required.     ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? COM server ghost DLLs                             ?
????????????????????????????????????????????????????????????????
? Check whether there are COM servers registered with a        ?
? non-existent module using a relative path. This may not      ?
? necessarily result in a privilege escalation. You would also ?
? need to have rights to create files in a PATH folder.        ?
? Further analysis is required.                                ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0003 - Persistence                              ?
? NAME     ? COM server missing module files                   ?
????????????????????????????????????????????????????????????????
? Check whether there are leftover COM servers registered with ?
? non-existent modules. Such issues could be leveraged for     ?
? lateral movement or persistence.                             ?
????????????????????????????????????????????????????????????????
[*] Status: Vulnerable - Low


Id       : {14BE1FB6-7B58-4724-BCF7-4389C7770F07}
Path     : HKLM\SOFTWARE\Classes\CLSID\{14BE1FB6-7B58-4724-BCF7-4389C7770F07}
Value    : InProcServer32
Data     : C:\Program Files (x86)\Microsoft\EdgeUpdate\1.3.135.41\psmachine_64.dll
DataType : FilePath

Id       : {31FB561A-CD57-4AF0-AE52-5652A86256B1}
Path     : HKLM\SOFTWARE\Classes\CLSID\{31FB561A-CD57-4AF0-AE52-5652A86256B1}
Value    : InProcServer32
Data     : C:\Program Files (x86)\Microsoft\EdgeUpdate\1.3.195.19\psmachine_64.dll
DataType : FilePath




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0001 - Initial Access                           ?
? NAME     ? Proxy auto-configuration URL                      ?
????????????????????????????????????????????????????????????????
? Check whether a proxy auto config URL is set, and whether    ?
? the proxy.pac file is retrieved over HTTP.                   ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0005 - Defense Evasion                          ?
? NAME     ? Windows Defender exclusions                       ?
????????????????????????????????????????????????????????????????
? Get information about the exclusions configured in Microsoft ?
? Defender.                                                    ?
????????????????????????????????????????????????????????????????
powershell.exe : Get-WinEvent : Attempted to perform an unauthorized operation.
    + CategoryInfo          : NotSpecified: (Get-WinEvent : ...ized operation.:String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError
At line:164 char:27+                 $Events = Get-WinEvent -LogName $LogName | Where-Obje ...+                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : NotSpecified: (:) [Get-WinEvent], UnauthorizedAccessException    + FullyQualifiedErrorId : System.UnauthorizedAccessException,Microsoft.PowerShell.Commands.Get    WinEventCommand [*] Status: Informational (nothing found)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0043 - Reconnaissance                           ?
? NAME     ? Network interfaces                                ?
????????????????????????????????????????????????????????????????
? Get information about all active Ethernet adapters.          ?
????????????????????????????????????????????????????????????????
[*] Status: Informational


Name            : {D85D5795-CCBF-4372-BF66-943445B4C236}
FriendlyName    : Ethernet0
Type            : Ethernet
Status          : Up
DnsSuffix       :
Description     : vmxnet3 Ethernet Adapter
PhysicalAddress : 00:50:56:b0:01:8b
Flags           : DdnsEnabled, NetBiosOverTcpIpEnabled, Ipv4Enabled
IPv6            :
IPv4            : 10.10.11.42 (/23)
Gateway         : 10.10.10.2
DHCPv4Server    :
DHCPv6Server    :
DnsServers      : 127.0.0.1
DNSSuffixList   :




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? TCP endpoints                                     ?
????????????????????????????????????????????????????????????????
? Get information about all the TCP ports that are in a LISTEN ?
? state. Note that the associated process is also listed.      ?
????????????????????????????????????????????????????????????????
[*] Status: Informational

IP   Proto LocalAddress    State      PID Name
--   ----- ------------    -----      --- ----
IPv4 TCP   0.0.0.0:21      LISTENING 2704 svchost
IPv4 TCP   0.0.0.0:88      LISTENING  688 lsass
IPv4 TCP   0.0.0.0:135     LISTENING  932 svchost
IPv4 TCP   0.0.0.0:389     LISTENING  688 lsass
IPv4 TCP   0.0.0.0:445     LISTENING    4 System
IPv4 TCP   0.0.0.0:464     LISTENING  688 lsass
IPv4 TCP   0.0.0.0:593     LISTENING  932 svchost
IPv4 TCP   0.0.0.0:636     LISTENING  688 lsass
IPv4 TCP   0.0.0.0:3268    LISTENING  688 lsass
IPv4 TCP   0.0.0.0:3269    LISTENING  688 lsass
IPv4 TCP   0.0.0.0:5985    LISTENING    4 System
IPv4 TCP   0.0.0.0:9389    LISTENING 2844 Microsoft.ActiveDirectory.WebServices
IPv4 TCP   0.0.0.0:47001   LISTENING    4 System
IPv4 TCP   0.0.0.0:49155   LISTENING 1540 svchost
IPv4 TCP   0.0.0.0:49158   LISTENING  688 lsass
IPv4 TCP   0.0.0.0:49163   LISTENING  668 services
IPv4 TCP   0.0.0.0:49168   LISTENING  688 lsass
IPv4 TCP   0.0.0.0:49183   LISTENING 2656 dns
IPv4 TCP   0.0.0.0:49217   LISTENING 2880 dfsrs
IPv4 TCP   0.0.0.0:49664   LISTENING  688 lsass
IPv4 TCP   0.0.0.0:49665   LISTENING  548 wininit
IPv4 TCP   0.0.0.0:49666   LISTENING 1236 svchost
IPv4 TCP   0.0.0.0:49667   LISTENING  688 lsass
IPv4 TCP   0.0.0.0:49669   LISTENING 1752 svchost
IPv4 TCP   10.10.11.42:53  LISTENING 2656 dns
IPv4 TCP   10.10.11.42:139 LISTENING    4 System
IPv4 TCP   127.0.0.1:53    LISTENING 2656 dns
IPv6 TCP   [::]:21         LISTENING 2704 svchost
IPv6 TCP   [::]:88         LISTENING  688 lsass
IPv6 TCP   [::]:135        LISTENING  932 svchost
IPv6 TCP   [::]:445        LISTENING    4 System
IPv6 TCP   [::]:464        LISTENING  688 lsass
IPv6 TCP   [::]:593        LISTENING  932 svchost
IPv6 TCP   [::]:5985       LISTENING    4 System
IPv6 TCP   [::]:9389       LISTENING 2844 Microsoft.ActiveDirectory.WebServices
IPv6 TCP   [::]:47001      LISTENING    4 System
IPv6 TCP   [::]:49155      LISTENING 1540 svchost
IPv6 TCP   [::]:49158      LISTENING  688 lsass
IPv6 TCP   [::]:49163      LISTENING  668 services
IPv6 TCP   [::]:49168      LISTENING  688 lsass
IPv6 TCP   [::]:49183      LISTENING 2656 dns
IPv6 TCP   [::]:49217      LISTENING 2880 dfsrs
IPv6 TCP   [::]:49664      LISTENING  688 lsass
IPv6 TCP   [::]:49665      LISTENING  548 wininit
IPv6 TCP   [::]:49666      LISTENING 1236 svchost
IPv6 TCP   [::]:49667      LISTENING  688 lsass
IPv6 TCP   [::]:49669      LISTENING 1752 svchost
IPv6 TCP   [::1]:53        LISTENING 2656 dns



????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? UDP endpoints                                     ?
????????????????????????????????????????????????????????????????
? Get information about all the UDP ports that are in a LISTEN ?
? state. Note that the associated process is also listed. DNS  ?
? is filtered out to minimize the output.                      ?
????????????????????????????????????????????????????????????????
[*] Status: Informational

IP   Proto LocalAddress    State  PID Name
--   ----- ------------    -----  --- ----
IPv4 UDP   0.0.0.0:123     N/A   1048 svchost
IPv4 UDP   0.0.0.0:389     N/A    688 lsass
IPv4 UDP   0.0.0.0:500     N/A   1556 svchost
IPv4 UDP   0.0.0.0:4500    N/A   1556 svchost
IPv4 UDP   0.0.0.0:5353    N/A   1152 svchost
IPv4 UDP   0.0.0.0:5355    N/A   1152 svchost
IPv4 UDP   0.0.0.0:49875   N/A   1152 svchost
IPv4 UDP   10.10.11.42:88  N/A    688 lsass
IPv4 UDP   10.10.11.42:137 N/A      4 System
IPv4 UDP   10.10.11.42:138 N/A      4 System
IPv4 UDP   10.10.11.42:464 N/A    688 lsass
IPv4 UDP   127.0.0.1:51583 N/A   2844 Microsoft.ActiveDirectory.WebServices
IPv4 UDP   127.0.0.1:52854 N/A   1424 svchost
IPv4 UDP   127.0.0.1:59995 N/A   2820 ismserv
IPv4 UDP   127.0.0.1:62204 N/A   2880 dfsrs
IPv4 UDP   127.0.0.1:62205 N/A   2272 dfssvc
IPv4 UDP   127.0.0.1:63542 N/A   1484 wsmprovhost
IPv4 UDP   127.0.0.1:64088 N/A   1704 svchost
IPv4 UDP   127.0.0.1:64500 N/A   3992 wsmprovhost
IPv6 UDP   [::]:123        N/A   1048 svchost
IPv6 UDP   [::]:500        N/A   1556 svchost
IPv6 UDP   [::]:4500       N/A   1556 svchost
IPv6 UDP   [::]:49875      N/A   1152 svchost



????????????????????????????????????????????????????????????????
? CATEGORY ? TA0001 - Initial Access                           ?
? NAME     ? Wi-Fi profiles                                    ?
????????????????????????????????????????????????????????????????
? Get information about saved Wi-Fi profiles. Clear-text       ?
? pre-shared keys (PSK) are displayed when possible, and       ?
? potentially vulnerable 802.1x profiles are listed.           ?
????????????????????????????????????????????????????????????????
WARNING: Exception calling "WlanOpenHandle" with "4" argument(s): "Unable to load DLL 'wlanapi':
The specified module could not be found. (Exception from HRESULT: 0x8007007E)"
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0001 - Initial Access                           ?
? NAME     ? Network selection from lock screen                ?
????????????????????????????????????????????????????????????????
? Check whether the 'Do not display network selection UI'      ?
? policy is enabled on workstations (CVE-2021-28316 -          ?
? Airstrike attack).                                           ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)


Description : Not a workstation, this check is irrelevant.




????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Last Windows Update date                          ?
????????????????????????????????????????????????????????????????
? Get information about the latest Windows update. Note that   ?
? this check might be unreliable.                              ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (nothing found)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Latest updates installed                          ?
????????????????????????????????????????????????????????????????
? Check whether a Windows security update was installed within ?
? the last 31 days.                                            ?
????????????????????????????????????????????????????????????????
Get-HotFix : Access denied At line:53 char:30+         foreach ($HotFix in (Get-HotFix)) {+                              ~~~~~~~~~~    + CategoryInfo          : NotSpecified: (:) [Get-HotFix], ManagementException    + FullyQualifiedErrorId : System.Management.ManagementException,Microsoft.PowerShell.Commands.    GetHotFixCommand [*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? Exploitable leaked handles                        ?
????????????????????????????????????????????????????????????????
? Check whether the current user has access to a process that  ?
? contains a leaked handle to a privileged process, thread, or ?
? file object.                                                 ?
????????????????????????????????????????????????????????????????
[*] Status: Informational (not vulnerable)

????????????????????????????????????????????????????????????????
? CATEGORY ? TA0004 - Privilege Escalation                     ?
? NAME     ? MSI unsafe Custom Actions                         ?
????????????????????????????????????????????????????????????????
? Get information about cached MSI files that execute          ?
? potentially unsafe Custom Actions. Note that a manual        ?
? analysis is required to determine if the returned MSI files  ?
? are actually vulnerable.                                     ?
????????????????????????????????????????????????????????????????



